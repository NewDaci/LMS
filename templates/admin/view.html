{% include 'admin/layout.html' %}

<div class="container mt-3 d-flex flex-column min-vh-100">

    {% for message in get_flashed_messages() %}
    <div class="alert alert-primary d-flex align-items-center">
        {{ message }}
        <button type="button" class="btn-close ms-auto" data-dismiss="alert"></button>
    </div>
    {% endfor %}

    <div class="container">
        <h1 class="fw-bold text-decoration-underline">Book Details</h1>

        <h3 class="fw-bold mt-3">
            ID : {{ book.id }}
        </h3>
        <h3 class="fw-bold">
            ISBN No : {{ book.isbn }}
        </h3>
        <h3 class="fw-bold">
            Name : {{ book.name }}
        </h3>
        <h3 class="fw-bold">
            Author : {{ book.author_name }}
        </h3>
        <h3 class="fw-bold">
            Section : {{ book.sections.name }}
        </h3>
        <h3 class="fw-bold">
            Language : {{ book.language }}
        </h3>
        <h3 class="fw-bold">
            Date Added : {{ book.date_added }}
        </h3>
    </div>
    <div class="mb-4 mt-3">
        <!-- Buttons -->
        <a href="/book-id/{{book.id}}" class="btn btn-primary">Read</a>
        <a href="/update/{{book.id}}" class="btn btn-success">Manage Book</a>
        <a href="/delete/{{book.id}}" class="btn btn-danger">Delete Book</a>
    </div>

    <div class="container">
        <h1 class="fw-bold text-decoration-underline">Users Enrolled</h1>
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">User ID</th>
                    <th scope="col">Name</th>
                    <th scope="col">Email</th>
                    <th scope="col">Action</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <th scope="row">{{loop.index}}</th>
                    <td>{{user.id}}</td>
                    <td>{{user.name}}</td>
                    <td>{{user.email}}</td>
                    <td>
                        <a href="/user_details/{{user.id}}"><button class="btn btn-primary">User Details</button></a>
                        <a href="/revoke/{{ book.enrollments[0].id }}" class="btn btn-danger">Revoke</a>
                    </td>
                </tr>
                {% endfor %}

            </tbody>
        </table>
        <h3>Total No. of Users Enrolled in this book : {{ i }} </h3>
    </div>

</div>

<!-- Java script code to make the cross button work in flash message -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

{% include 'footer.html' %}